CREATE TABLE IF NOT EXISTS DATASOURCE (
    NAME VARCHAR(50) NOT NULL PRIMARY KEY,
    MAXACTCONN INTEGER,
    DRIVERCLASS VARCHAR(50) NOT NULL,
    IDLECONN INTEGER,
    USERNAME VARCHAR(50),
    PASSWORD VARCHAR(150),
    URL VARCHAR(512) NOT NULL,
    QUERY VARCHAR(100),
    WAIT INTEGER
    );

CREATE USER IF NOT EXISTS sa PASSWORD '';
CREATE USER IF NOT EXISTS hibuser PASSWORD 'password';
CREATE USER IF NOT EXISTS pentaho_user PASSWORD 'password';

GRANT ALTER ANY SCHEMA TO sa;
GRANT ALTER ANY SCHEMA TO hibuser;
GRANT ALTER ANY SCHEMA TO pentaho_user;

INSERT INTO DATASOURCE (NAME, MAXACTCONN, DRIVERCLASS, IDLECONN, USERNAME, PASSWORD, URL, QUERY, WAIT)
SELECT 'SampleData', 20, 'org.h2.Driver', 5, 'pentaho_user', 'Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde', 'jdbc:h2:../../data/h2/sampledata', 'select count(*) from SYSTEM_SEQUENCES', 1000
    WHERE NOT EXISTS (SELECT 1 FROM DATASOURCE WHERE NAME = 'SampleData');
